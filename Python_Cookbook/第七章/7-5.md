## 函数的可选参数

**问题**

你想要顶一个函数或方法，它带有一个或多个可选参数并且这些可选参数都具有默认值。

**解决方案**

表面上定义一个一个函数的可选参数非常简单，只需要给参数值，并且确保它在参数的最后位置。比如：

    def spam(a, b=42):
        print(a, b)
        
    spam(1) # OK. a=1, b=42
    spam(1, 2)  # OK. a=1, b=2

如果默认值是一个可变的值，比如列表，集合， 或者是字典，就要像这样用 None 作为默认值：

    # 用 None 作为一个列表的默认值
    def spam(a, b=None):
        if b is None:
            b = []
        ...
        
如果你不想提供默认值，只是想测试这个可选参数是否传入。可以用这个惯用写法：

    _no_value = object()
    
    def spam(a, b=_no_value):
        if b is _no_value:
            print('b 没有被传入。')
            
下面是这个函数如何的结果：

    >>> spam(1)
    No b value supplied
    >>> spam(1, 2)  # b = 2
    >>> spam(1, None)   # b = None
    
请小心区别 传入的参数为 None 和没有传入参数。

**讨论**

定义一个可选参数非常简单，但是在结束前还是要啰嗦几句。

首先，作为一个默认值赋值操作只在函数定义的时候，我们看个例子：

    >>> x = 42
    >>> def spam(a, b=x):
        print(a, b)

    >>> spam(1)
    1 42
    >>> x = 23  # 改变一下 x 的值，但是没有任何影响
    >>> spam(1)
    1 42
    >>> 
    
注意无论 x 怎么改变都不会影响这个函数的默认参数，这是因为默认值是在定义时候就进行了编译。

其次，默认值必须是不可变的，比如 None, True, 数字，字符串。特别强调，千万不要些这样的代码：

    def spam(a, b=[]):
        ...
        
如果你这么做，当这个参数被修改的时候，将会引出一系列的麻烦。这种改变将会永久的改变在未来调用的时候的这个函数的默认值：

    >>> def spam(a, b=[]):
        print(b)
        return b

    >>> x = spam(1)
    []
    >>> x.append(99)
    >>> x.append('lala!')
    >>> x
    [99, 'lala!']
    >>> spam(1)
    [99, 'lala!']
    [99, 'lala!']
    >>> 
    
这个可不是你想要的。为了避免这个，我们用 None 作为默认值，然后检测是否传入了参数来解决。

is 的操作符是用来测试 None 是非常严肃的。有时候人们会犯这种错误：

    def spam(a, b=None):
        if not b:
         b = []

这里的问题是，不管传入的值是None 或者 False 或者是其他的对象（比如 0 长度的字符串， 列表，元组，字典等等）也是为真。因此，在测试的时候也会错误的认为传入的参数是丢失了。比如：
   
    >>> spam(1)
    >>> x = []
    >>> spam(1, x) # 这里没有报错，但是 x 已经被默认值覆盖了。
    >>> spam(1, 0)  # 这里没有报错，但是 0 被忽略了。
    >>> spam(1, '') # 这里没有报错，但是 '' 被忽略了。
    >>> 

最后一部分是一些不易察觉的事情，一个函数测试要看这个值是否被传给可选参数。这个技巧就是，你不能用默认的值 None， 0 或者 False 来测试当前的可选参数。（尽管这些值是用户可能会输入的。）因此，你还是需要其他值再次测试。

解决这个问题，你可以创建一个唯一的私有的对象，就像我们上个解决方案（ _no_value 变量 ）。在那里，你可以检查传入的值是否被传入。并且想一下没有用户会输入传入这个对象。因此，这个变得安全了。

object() 对象可能看起来很奇怪。 object 是 Python 中所有对象得最基本的类。你可以创建一个 object 对象， 但是它没有任何意义，因为它没有任何方法和任何实例，因为他没有对象字典，你不能设置属性）。你唯一能做的事情就是测试是否唯一。这在一些特殊值的时候非常有用，可以作为我们判断是否传入值的解决方案。

